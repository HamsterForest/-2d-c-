#include<stdio.h>
#include<time.h>
#include<windows.h>
#include<conio.h>
#include<mmsystem.h>
#pragma comment(lib,"winmm.lib");

typedef enum { false, true } bool; //bool을 사용하기 위해 bool을 정의 해줌 

#define _CRT_SECURE_NO_WARNINGS
#define HEIGHT 30
#define WIDTH 50
#define A 55//sleep

#define _LOWC 523.2511//효과음 낮은 도
#define _C 1046.502//효과음 도
#define _E 1318.510//효과음 미
#define _G 1567.982//효과음 솔

bool index_portaltime;//포탈의 시간을 지연시키기 위해 만든 전역변수
int index_portalcount;//포탈 생성 개수 제한하는 전역변수
int index_key = 4;//startmanagement에서 사용하는 열쇠 전역변수
bool index_swapstage = false;//스테이지 변환을 위한 전역변수 true이면 스테이지 변환 false이면 변환하지 않고 바로 다음함수로
int index_stage = 0;//스테이지 변환을 위한 전역변수 이 값을 통해 어떤 스테이지로 변환할지 결정
bool index_pass = false;//오류 해결을 위한 전역변수
int index_life = 5;
clock_t start_timecheck, end_timecheck, result_time; //시간 측정을 위한 전역 변수
clock_t start_portal, end_portal;//발사체 발사에서 시간 지연을 위한 전역변수
int skip;
int dir_bullet;//방향전역변수, bulletprocess와 연결됨

typedef struct obj //화면에 등장하는 움직이는 구조물을 다룸(플레이어,총알)
{
	int x;
	int y;
	bool Active;//총알의 진행여부,플레이어의 조종여부
	bool portala;//포탈의 현재 상태 false면은 첫포탈 발사 true면 두번째 포탈 발사
	bool fActive;//중력장
	int fdir;
}obj;

obj stPlayer = { 0,0,true,true,true };//플레이어의 구조체 
obj bullet = { 0,0,false,false };//총알
obj startcursor = { 8,13 };//메뉴용 커서

typedef struct portalinfo {//포탈이 생성된 위치가 저장됨
	int x;
	int y;
}portalinfo;

portalinfo portalinformation[3];//[0]에는 아무것도 들어오지 않는다. 정보는 1,2에 저장됨

typedef struct {//점수가 임시로 저장 됨
	char name[30];
	long score;
}result;

result player[11] = { {"player",2147483647}, {"player",2147483647}, {"player",2147483647},
					{"player",2147483647}, {"player",2147483647}, {"player",2147483647},
					{"player",2147483647},{"player",2147483647}, {"player",2147483647}, {"player",2147483647},{"player",2147483647} };

typedef struct stage
{
	int map[HEIGHT][WIDTH];
}stage;

stage represent = {{
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,1,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,6,0,0,0,6,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,1,0,5,0,1,0,1,0,2,0,1,0,1,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,6,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,5,0,5,0,8,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,6,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//20
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//26
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30
//                 0   2   4   6   8  

stage first = { {
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,5,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,6,0,0,0,6,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,8,0,0,0,8,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,1,0,5,0,1,0,1,0,2,0,1,0,1,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,5,0,5,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,6,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,7,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0},//20
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,8,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {2,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,6,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {2,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//26
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30

stage second = { { {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},//12 11
				  {2,0,1,0,0,0,6,0,0,0,0,0,2,0,1,0,1,0,1,0,1,0,1,0,2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0},
				  {2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,1,0,2,0},//14 13
				  {2,0,1,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,6,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,6,0,0,0,1,0,2,0},
				  {2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,1,0,2,0},//16 15
				  {2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,1,0,2,0},
				  {2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,1,0,2,0},//18
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,5,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//20
				  {8,0,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,8,0,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {8,0,8,0,8,0,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,8,0,8,0,8,0,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {8,0,8,0,8,0,8,0,8,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,2,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0,8,0},
				  {5,0,5,0,5,0,5,0,5,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},//26
				  {1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30

stage third = { {
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,8,0,8,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {2,0,5,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,1,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,2,0,1,0,0,0,2,0,2,0,1,0,1,0,1,0,1,0,2,0,1,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,6,0,0,0,2,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,2,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {2,0,2,0,1,0,2,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,1,0,2,0,5,0,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {2,0,2,0,2,0,2,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,6,0,0,0,0,0,5,0,5,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,1,0,1,0,1,0,1,0,2,0,1,0,0,0,0,0,1,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,1,0,2,0,5,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,5,0,2,0,2,0,2,0,2,0,2,0,6,0,0,0,1,0,1,0,1,0,2,0,8,0,9,9,9,9,9,9,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {2,0,0,0,2,0,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,0,8,0,2,0,8,0,9,9,9,9,9,9,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,0,0,2,0,0,0,2,0,5,0,5,0,5,0,5,0,5,0,5,0,1,0,2,0,1,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,1,0,2,0,2,0,2,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,8,0,8,0,8,0,0,0,0,0,0,0,9,9,9,9,9,9,9,9,9,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//20
				  {2,0,2,0,2,0,2,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,0,0,0,0,5,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {2,0,0,0,6,0,5,0,0,0,5,0,1,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,0,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,7,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {2,0,8,0,9,9,9,9,9,9,2,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,5,0,2,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//26
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30


stage forth = { {
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,6,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,0,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {8,0,8,0,8,0,8,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {1,0,1,0,1,0,1,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {1,0,1,0,1,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {1,0,1,0,1,0,1,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {1,0,1,0,1,0,1,0,0,0,0,0,5,0,0,0,9,9,9,9,9,9,9,9,9,9,9,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {8,0,8,0,8,0,2,0,2,0,2,0,2,0,8,0,9,9,9,0,6,0,9,9,9,9,9,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,8,0,8,0,2,0,1,0,0,0,2,0,7,0,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {8,0,8,0,8,0,0,0,0,0,0,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,5,0,0,0,5,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,8,0,8,0,2,0,5,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {8,0,8,0,8,0,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,8,0,0,0,0,0,0,0,1,0,2,0,2,0,2,0,2,0,1,0,2,0,2,0,2,0,2,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {2,0,0,0,2,0,2,0,0,0,0,0,5,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {1,0,0,0,0,0,2,0,6,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//20
				  {2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,5,0,5,0,5,0,2,0,2,0,2,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {2,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,2,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0},
				  {2,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//26
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30



stage fifth = { { {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,6,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {1,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,1,0,1,0,1,0,2,0,2,0,2,0,5,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,2,0,1,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,1,0,1,0,1,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,2,0,1,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,6,0,2,0,5,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,1,0,1,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {0,0,2,0,1,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,1,0,1,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {0,0,2,0,1,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,6,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//20
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,1,0,1,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//22
				  {0,0,2,0,1,0,1,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,6,0,0,0,7,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//24
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//26
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30


stage sixth = { { {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,1,0,1,0,0,0,2,0,2,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0},//2 1
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,10,10,10,10,10,10,10,0,8,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,6,0,0,0,0,0,0,0,0,0,2,0,5,0,2,0,2,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0},//4 3
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,2,0,5,0,2,0,0,0,2,0,1,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//6 5
				  {0,0,2,0,2,0,2,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {10,10,10,10,10,10,10,10,10,10,10,0,8,0,5,0,0,0,0,0,5,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,6,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},
				  {2,0,2,0,2,0,2,0,2,0,2,0,0,0,1,0,0,0,0,0,5,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {8,0,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,0,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,2,0},
				  {2,0,0,0,0,0,2,0,5,0,5,0,2,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,1,0},//12 11
				  {2,0,2,0,1,0,2,0,1,0,1,0,1,0,5,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},
				  {0,0,2,0,2,0,2,0,0,0,0,0,0,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,1,0},//14 13
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,1,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,2,0,5,0,2,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,2,0,0,0,5,0,0,0,0,0,0,0,2,0,2,0,2,0,0,0,0,0,0,0,0,0},//18
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,5,0,2,0,2,0,0,0,5,0,0,0,5,0,0,0,0,0,0,0,5,0,1,0,2,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,2,0,0,0,5,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0},//20
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,2,0,5,0,2,0,2,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,2,0,2,0,0,0,0,0},//22
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,8,0,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,2,0,0,0,2,0,0,0,0,0},//24
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,5,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,0,0,2,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0},//26
				  {2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0,2,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30



stage finale = { { {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//2 1
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
			   	  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//4 3
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//6 5
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//8 7
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//10 9
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//12 11
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//14 13
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//16 15
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//18
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//20
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//22
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//24
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},//26
				  {0,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,6,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},//28
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0} } };//30

void constant_manage(void);//별을 먹고 다음 단계로 넘어가게 함, 중력장을 빠져나오게 함, 점수를 저장하게함
void updatestageprocess(stage *initalsage, stage *y);//스테이지 스왑-스테이지 업데이트에서 사용함
void updatestage(void);//스테이지 업데이트
void SetColor(unsigned char _Bgcolor, unsigned char _TextColor);//배경 글자 색
void clear(void);//화면을 비움
void gotoxy(int x, int y);//커서이동
void draw_map(stage *map);//스테이지 그리기
void start(void);//첫 화면
void howto_a(void);//두번째 화면
void howto_b(void);//세번째 화면
void howto_c(void);//네번째 화면
void howto_d(void);//다섯번째 화면
void whererureal(void);//임시 
void init(void);//초기화 콘솔크기 등
void erasecursor(void);//메뉴에서 사용하는거
void cursorsupply(void);//==
void eraseplayer(void);//잔상을 없애기 위함, 플레이어
void playersupply(void);//플레이어를 그림
void erasebullet(void);//잔상을 없애기 위함, 총알
void bulletsupply(int direction);//총알을 그림
void portalreset(void);//포탈 초기화
void portalprocess(int x, int y);//포탈을 그리고 포탈의 위치정보를 저장함
void bulletprocess(int dir_bullet);//총알을 이동시키는 등의 처리
void vectorfield(void);//중력장 입장시 한쪽방향으로의 이동
void inputfunction(void);//입력처리, 포탈 연결
void deadmenu(void);//플레이어가 죽었을 경우
void sortscore(void);//점수 선택정렬
void resultmenu(void);//점수 파일에 기록, 파일에서 읽어오기, 파일 내용 정리, 화면에 랭킹결과 보여줌
void gamemain(void);

void constant_manage(void)
{
	if (represent.map[stPlayer.y][stPlayer.x] == 8) {//죽음
		stPlayer.x = 30; //플레이어 구조체가 처음 등장하는 좌표
		stPlayer.y = 15;//==
		portalreset();
		Beep(_C, 50);
		Beep(_C, 50);
		playersupply();
		index_life--;
	}
	if (index_life == 0) stPlayer.Active = false;
	if (represent.map[stPlayer.y][stPlayer.x] == 6) {
		Beep(_G, 100);
		index_key--;
		represent.map[stPlayer.y][stPlayer.x] = 0;
	}
	if (index_key == 0 && represent.map[stPlayer.y][stPlayer.x] == 7) {
		Beep(_E, 60);
		Beep(_C, 60);
		Beep(_G, 60);
		index_swapstage = true;
		if (index_stage == 6) {			
			end_timecheck = clock();
			result_time = end_timecheck - start_timecheck;//마지막 단계를 마치고 목표지점으로 이동하면 플레이한 시간 기록
		}
	}
	if (represent.map[stPlayer.y][stPlayer.x] != 9 && represent.map[stPlayer.y][stPlayer.x] != 10) {//중력장 해제
		stPlayer.fActive = true;
		stPlayer.fdir = 0;
	}
}

void updatestageprocess(stage *initalsage, stage *y) {

	*initalsage = *y;
}

void updatestage(void)
{
	if (index_swapstage == false) return 0;
	stPlayer.x = 30; //플레이어 구조체가 처음 등장하는 좌표
	stPlayer.y = 15;//==
	clear();//잔상제거
	playersupply();//플레이어 위치조정
	if (index_swapstage == true && index_stage == 0) {
		updatestageprocess(&represent, &first);
		index_swapstage = false;
		index_stage = 1;//다음스테이지로 넘어가게 하기위해
		index_key = 4;//열쇠수 초기화
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}

	if (index_swapstage == true && index_stage==1){
		updatestageprocess(&represent, &second);
		index_swapstage = false;
		index_stage = 2;//다음스테이지로 넘어가게 하기위해
		index_key = 4;//열쇠수 초기화
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
	if (index_swapstage == true && index_stage == 2) {
		updatestageprocess(&represent, &third);
		index_swapstage = false;
		index_stage = 3;
		index_key = 4;
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
	if (index_swapstage == true && index_stage == 3) {
		updatestageprocess(&represent, &forth);
		index_swapstage = false;
		index_stage = 4;
		index_key = 4;
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
	if (index_swapstage == true && index_stage == 4) {
		updatestageprocess(&represent, &fifth);
		index_swapstage = false;
		index_stage = 5;
		index_key = 4;
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
	if (index_swapstage == true && index_stage == 5) {
		updatestageprocess(&represent, &sixth);
		index_swapstage = false;
		index_stage = 6;
		index_key = 4;
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
	if (index_swapstage == true && index_stage == 6) {
		updatestageprocess(&represent, &finale);
		index_swapstage = false;
		index_stage = 7;
		bullet.portala = false;//포탈 초기화
		index_portalcount = 0;//포탈초기화
	}
}

void SetColor(unsigned char _Bgcolor, unsigned char _TextColor)//배경 글자색 설정 함수
{
	if (_Bgcolor > 15 || _TextColor > 15) return;

	unsigned short ColorNum = (_Bgcolor << 4) | _TextColor;
	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), ColorNum);
}

void clear(void)//화면을 비워줌
{			   
	system("cls");
}

void gotoxy(int x, int y)//커서를 이동시켜줌
{

	COORD pos = { x,y };

	SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), pos);

}

void draw_map(stage *map) {

	for (int i = 0; i < HEIGHT; i++) {
		for (int j = 0; j < WIDTH; j++) {
			
				if (map->map[i][j] == 1) {
					gotoxy(j, i);
					printf("▤");//벽
				}
				if (map->map[i][j] == 2) {
					gotoxy(j, i);
					printf("▒");//포탈못만드는벽
				}
				if (map->map[i][j] == 3) {
					gotoxy(j, i);
					printf("○");//제1포탈
				}
				if (map->map[i][j] == 4) {
					gotoxy(j, i);
					printf("●");//제2포탈
				}
				if (map->map[i][j] == 5) {
					gotoxy(j, i);
					printf("□");//유리
				}
				if (map->map[i][j] == 6) {
					gotoxy(j, i);
					printf("★");//키
				}
				if (map->map[i][j] == 7) {
					gotoxy(j, i);
					printf("◈");//목표
				}
				if (map->map[i][j] == 8) {
					gotoxy(j, i);
					printf("▲");//장애물 
				}
				if (map->map[i][j] == 9) {
					gotoxy(j, i);
					printf("<");//장애물 
				}
				if (map->map[i][j] == 10) {
					gotoxy(j, i);
					printf(">");//장애물 
				}
		}

	}
	if (index_stage < 7) {
		gotoxy(42, 0);
		printf("stage %d", index_stage);
		gotoxy(42, 2);
		printf("★ : %d", index_key);
		gotoxy(42, 4);
		printf("♥ : %d", index_life);
		gotoxy(2, 28);
		printf("Collect the stars\n  Don't forget to reset portal by 'r'", index_key);
	}
	else {//피날레 스테이지용
		gotoxy(8, 7);
		printf("당신은 이제 자유입니다.");
		gotoxy(8, 9);
		printf("모든 스테이지를 클리어했습니다!!!");
		gotoxy(8, 11);
		printf("점수를 보려면 스페이스바를 누르세요!");
	}
}

void start(void)
{	
	clear();
	cursorsupply();
	while (1)
	{
		gotoxy(10, 6);
		printf("○ P O R T A L ●");
		gotoxy(10, 13);
		printf("◇ 게임 시작");
		gotoxy(10, 16);
		printf("◇ 랭킹");
		gotoxy(10, 19);
		printf("◇ 종료");
		gotoxy(10, 28);
		printf("방향키로 이동 스페이스바로 선택");
		if (GetAsyncKeyState(VK_DOWN) & 0X8000) {
			Beep(_C, 100);
			if (startcursor.y <= 16) {
				erasecursor();
				startcursor.y = startcursor.y + 3;
				cursorsupply();
				Sleep(A+200);
			}
			else {
				erasecursor();
				startcursor.y = 13;
				cursorsupply();
				Sleep(A+200);
			}
		}
		if (GetAsyncKeyState(VK_UP) & 0X8000) {
			Beep(_C, 100);
			if (startcursor.y >= 16) {
				erasecursor();
				startcursor.y = startcursor.y - 3;
				cursorsupply();
				Sleep(A + 200);
			}
			else {
				erasecursor();
				startcursor.y = 19;
				cursorsupply();
				Sleep(A + 200);
			}
		}
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			Beep(_C, 50);
			Beep(_E, 50);
			if (startcursor.y == 13) {
				return;
			}
			else if (startcursor.y == 16) {
				resultmenu(0);
				cursorsupply();
			}
			else if (startcursor.y == 19) {
				exit(1);
			}
		}
	}
}

void howto_a(void)
{
	clear();
	Sleep(500);
	while (1)
	{
		gotoxy(10, 3);
		printf("▣ <- 이것이 당신입니다.");
		gotoxy(2, 6);
		printf("당신의 목적은");
		gotoxy(2, 9);
		printf("4개의 ★을 모으고");
		gotoxy(2, 12);
		printf("목적지인 ◈으로 이동 하는 곳입니다.");
		gotoxy(2, 15);
		printf("총 6개의 스테이지가 있습니다.");
		gotoxy(2, 18);
		printf("모든 스테이지를 마치면 게임은 마무리됩니다.");
		gotoxy(2, 21);
		printf("6개의 스테이지를 마친 시간이 점수로 기록됩니다.");
		gotoxy(5, 26);
		printf("○다음 페이지=스페이스바를 누르세요!●");
		gotoxy(6, 28);
		printf("○설명을 스킵하려면 'z'를 누르세요!●");
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			Beep(_C, 100);
			return 0;
		}
		if (GetAsyncKeyState(0x5A) & 0X8000) {
			Beep(_C, 100);
			index_swapstage = true;
			skip = 1;
			return 0;
		}
	}
}

void howto_b(void)
{
	if (skip == 1)return;
	clear();
	Sleep(500);
	while (1)
	{
		gotoxy(2, 3);
		printf("한 쌍의 포탈을 발사 할 수 있습니다. ○ ●");
		gotoxy(2, 6);
		printf("포탈을 벽에 발사할 수 있습니다.");
		gotoxy(2, 9);
		printf("그러면 벽이 포탈로 변합니다.");
		gotoxy(2, 12);
		printf("한 포탈에 입장하면 다른 포탈로 나옵니다.");
		gotoxy(2, 15);
		printf("▤▤▤▤ <=형태의 벽에만 포탈이 생성 됩니다.");
		gotoxy(2, 18);
		printf("□□□□ <=이벽은 유리입니다.");
		gotoxy(2, 21);
		printf("유리는 포탈을 생성하는 발사체를\n  그대로 통과 시킵니다.");
		gotoxy(5, 26);
		printf("○다음 페이지=스페이스바를 누르세요!●");
		gotoxy(6, 28);
		printf("○설명을 스킵하려면 'z'를 누르세요!●");
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			Beep(_C, 100);
			return 0;
		}
		if (GetAsyncKeyState(0x5A) & 0X8000) {
			Beep(_C, 100);
			index_swapstage = true;
			skip = 1;
			return 0;
		}
	}
}

void howto_c(void)
{
	if (skip == 1)return;
	clear();
	Sleep(500);
	while (1)
	{
		gotoxy(2, 1);
		printf("▲▲▲▲는 가시입니다.");
		gotoxy(2, 4);
		printf("가시에 다으면 당신은 '죽으며'");
		gotoxy(2, 7);
		printf("해당 단계의 처음 위치로 돌아갑니다.");
		gotoxy(1, 8);
		printf("(5번 죽으면 처음단계부터 다시 시작해야 합니다.)");
		gotoxy(2, 10);
		printf("<<<<<<<< 는 중력장입니다.");
		gotoxy(2, 13);
		printf("이 위로 올라가면 왼쪽(혹은 오른쪽)으로 이동하며");
		gotoxy(2, 16);
		printf("위혹은 아래로 이동하여 벗어날 수 있습니다.");
		gotoxy(2, 19);
		printf("중력장안에 있는 동안에는");
		gotoxy(2, 22);
		printf("좌우로 이동 할 수 없습니다.");
		gotoxy(5, 26);
		printf("○다음 페이지=스페이스바를 누르세요!●");
		gotoxy(6, 28);
		printf("○설명을 스킵하려면 'z'를 누르세요!●");
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			Beep(_C, 100);
			return;
		}
		if (GetAsyncKeyState(0x5A) & 0X8000) {
			Beep(_C, 100);
			index_swapstage = true;
			skip = 1;
			return;
		}
	}
}

void howto_d(void)
{
	if (skip == 1)return;
	clear();
	Sleep(500);
	while (1)
	{
		gotoxy(1, 1);
		printf("+케릭터 이동(방향키 사용)\n\n 상 : ↑\n\n 하 : ↓\n\n 좌 : ←\n\n 우 : →");
		printf("\n\n +포탈 발사(w,a,s,d 문자키 사용)\n\n 상 : W\n\n 하 : S\n\n 좌 : A\n\n 우 : D");
		printf("\n\n 한쌍의 포탈을 발사한 후에는\n\n R키를 이용해 리셋후 사용 할 수 있습니다.");
		printf("\n\n\n  ○게임을 시작하려면 스페이스바를 누르세요!●");
		gotoxy(20, 6);
		printf("플레이어 모습 : ▣");
		gotoxy(20, 15);
		printf("포탈리셋 : R");
		index_swapstage = true;
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			Beep(_C, 100);
			return;
		}
	}
}


void whererureal(void)//플레이어 위치 감시
{
	gotoxy(1, 1);
	printf("px: %d py: %d bx: %d by: %d   ", stPlayer.x, stPlayer.y, bullet.x, bullet.y);
	gotoxy(1, 2);
	printf("bullet : %d portal : %d    ", bullet.Active, bullet.portala);
	printf("%d %d %d %d   ", represent.map[14][12], represent.map[14][13], represent.map[14][14], represent.map[14][15]);
}

void init(void) //초기화를 해주는 함수
{

	system("mode con cols=50 lines=30"); //콘솔창의 사이즈
	SetColor(15, 0);
	CONSOLE_CURSOR_INFO curinfor;
	GetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &curinfor);
	curinfor.bVisible = FALSE;//커서를 안보이게 함
	SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &curinfor);
	
}

void eraseplayer(void)
{
	gotoxy(stPlayer.x, stPlayer.y);
	printf("  ");
}

void playersupply(void)//플레이어의 행동을 다룸
{

	gotoxy(stPlayer.x, stPlayer.y);//초기화 함수에서 좌표가 지정됨
	printf("▣");//플레이어를 출력함

}

void erasecursor(void)
{
	gotoxy(startcursor.x, startcursor.y);
	printf("  ");
}

void cursorsupply(void)
{
	gotoxy(startcursor.x, startcursor.y);
	printf(">");
}

void erasebullet(void)
{
	gotoxy(bullet.x, bullet.y);
	printf("  ");
}

void bulletsupply(int direction)
{
	dir_bullet = direction;

	switch (direction) {
		
	case 1:
		bullet.x = stPlayer.x + 2;//오른쪽
		bullet.y = stPlayer.y;
		gotoxy(bullet.x, bullet.y);
		printf("◎");
		break;

	case 2:
		bullet.x = stPlayer.x;//아래쪽
		bullet.y = stPlayer.y+1;
		gotoxy(bullet.x, bullet.y);
		printf("◎");
		break;
		
	case 3:
		bullet.x = stPlayer.x - 2;//왼쪽
		bullet.y = stPlayer.y;
		gotoxy(bullet.x, bullet.y);
		printf("◎");
		break;

	case 4:
		bullet.x = stPlayer.x;//위
		bullet.y = stPlayer.y-1;
		gotoxy(bullet.x, bullet.y);
		printf("◎");
		break;
	}
	
}

void portalreset(void)//포탈리셋
{
	if (index_portalcount == 0) return;
	if (index_portalcount == 1) {
		represent.map[portalinformation[1].y][portalinformation[1].x] = 1;
		bullet.portala = false;
		index_portalcount = 0;
		return;
	}
	represent.map[portalinformation[1].y][portalinformation[1].x] = 1;//포탈이 하나만 발사된 상태에서는 포탈이동이 불가능하도록
	represent.map[portalinformation[2].y][portalinformation[2].x] = 1;
	bullet.portala = false;
	index_portalcount = 0;
}



void portalprocess(int x, int y)//포탈을 생성하고 포탈의 위치를 저장함 정보저장은 portalinfo에
{
	Beep(_LOWC, 100);
	if ((dir_bullet == 2 && represent.map[bullet.y - 1][bullet.x] == 1) || (dir_bullet == 4 && represent.map[bullet.y + 1][bullet.x] == 1)) {
		if (dir_bullet == 2) {//↑벽에 붙어 발사시 한칸을 스킵하는 현상이 일어나 이를 방지함, 아래방향
			if (bullet.portala != true) {
				represent.map[y - 1][x] = 3;
				bullet.portala = true;
				portalinformation[index_portalcount].x = x;
				portalinformation[index_portalcount].y = y - 1;
				return;//함수탈출
			}
			if (bullet.portala == true) {
				represent.map[y - 1][x] = 4;
				bullet.portala = false;
				portalinformation[index_portalcount].x = x;
				portalinformation[index_portalcount].y = y - 1;
			}
		}
		if (dir_bullet == 4) {//위방향
			if (bullet.portala != true) {
				represent.map[y + 1][x] = 3;
				bullet.portala = true;
				portalinformation[index_portalcount].x = x;
				portalinformation[index_portalcount].y = y + 1;
				return;//함수탈출
			}
			if (bullet.portala == true) {
				represent.map[y + 1][x] = 4;
				bullet.portala = false;
				portalinformation[index_portalcount].x = x;
				portalinformation[index_portalcount].y = y + 1;
			}
		}
	}

	else {//벽에 붙은 위와 아래방향이아니거나 오른,왼방향일때 
		if (bullet.portala != true) {
			represent.map[y][x] = 3;
			bullet.portala = true;					
			portalinformation[index_portalcount].x = x;
			portalinformation[index_portalcount].y = y;
			return;//함수탈출
		}
		if (bullet.portala == true) {
			represent.map[y][x] = 4;
			bullet.portala = false;
			portalinformation[index_portalcount].x = x;
			portalinformation[index_portalcount].y = y;
		}
	}
}

void bulletprocess(int dir_bullet)
{
	switch (dir_bullet) {
		
	case 1:
		if (index_pass == false) erasebullet(); //밑의 네번째 조건문에 만족한경우 총알을 그리지 않고 함수를 끝낸다
		if (index_pass == true) index_pass = false; //그런경우 erasebullet을 실행할경우 맵이 뭉게지며 이는 이를 방지함
		bullet.x++;//오른쪽
		gotoxy(bullet.x, bullet.y);
		if ((bullet.x == (WIDTH-1) || represent.map[bullet.y][bullet.x + 1] == 2 || represent.map[bullet.y][bullet.x-1] == 2)&& represent.map[bullet.y][bullet.x-1] != 1) {
			bullet.Active = false;//최외벽또는 2번벽에 부딪히면 사라짐
			index_portalcount = index_portalcount - 1;//최외벽또는 2번벽에 부딪히는 걸로 포탈 카운트를 하지 않도록
			break;
		}
		if (represent.map[bullet.y][bullet.x - 1] == 1|| represent.map[bullet.y][bullet.x - 1] == 2) {//벽에 붙어서 발사하는 경우 그 벽을 통과하는 것을 방지함
			bullet.Active = false;
			portalprocess(bullet.x - 1, bullet.y);
			break;
		}
		if (represent.map[bullet.y][bullet.x+1] == 1) {//벽에 부딪히면 사라지고 포탈소환
			bullet.Active = false;
			portalprocess(bullet.x+1, bullet.y);
			break;
		}
		if (represent.map[bullet.y][bullet.x + 1] > 2 || represent.map[bullet.y][bullet.x] > 2) {
			bullet.x = (bullet.x + 2);//총알이 벽이 아닌 물체를 통과할경우 발생하는 오류해결
			index_pass = true;
			break;//좌우 이동시 총알을 지우는 과정즉 printf("  ")를 삽입하는 과정에서 삽입 뒤부터 밀려나는 현상을 막아줌
		}
		printf("◎");
		Sleep(A - 35);
		break;

	case 2:
		
		erasebullet();
		bullet.y++;//아래쪽
		gotoxy(bullet.x, bullet.y);
		if ((bullet.y == (HEIGHT) || represent.map[bullet.y][bullet.x] == 2 || represent.map[bullet.y-1][bullet.x] == 2)&& represent.map[bullet.y-1][bullet.x] != 1) {
			bullet.Active = false;//콘솔창을 벗어나면 총알 삭제
			index_portalcount = index_portalcount - 1;//벽에 부딪히는 걸로 포탈 카운트를 하지 않도록
			break;
		}
		if (represent.map[bullet.y][bullet.x] == 1|| represent.map[bullet.y-1][bullet.x] == 1) {
			bullet.Active = false;//벽에 부딪히면 삭제 
			portalprocess(bullet.x, bullet.y);
			break;
		}
		printf("◎");
		Sleep(A - 10);
		break;

	case 3:
		if (index_pass == false) erasebullet(); //밑의 네번째 조건문에 만족한경우 총알을 그리지 않고 함수를 끝낸다
		if (index_pass == true) index_pass=false; //그런경우 erasebullet을 실행할경우 맵이 뭉게지며 이는 이를 방지함
		bullet.x--;//왼쪽
		gotoxy(bullet.x, bullet.y);
		if ((bullet.x == 0 || represent.map[bullet.y][bullet.x + 1] == 2 || represent.map[bullet.y][bullet.x-1] == 2)&& represent.map[bullet.y][bullet.x + 1] != 1) {
			bullet.Active = false;//최외벽에 부딪히면 사라짐, 2형태 벽에 부딪히면 사라짐
			index_portalcount = index_portalcount - 1;//최외벽에 부딪히는 걸로 포탈 카운트를 하지 않도록
			break;
		}
		if (represent.map[bullet.y][bullet.x + 1] == 1) {//벽에 붙어서 발사하는 경우 그 벽을 통과하는 것을 방지함
			bullet.Active = false;
			portalprocess(bullet.x + 1, bullet.y);
			break;
		}
		if (represent.map[bullet.y][bullet.x - 1] == 1) {//벽에 부딪히면 사라지고 포탈소환
			bullet.Active = false;
			portalprocess(bullet.x - 1, bullet.y);
			break;
		}
		if (represent.map[bullet.y][bullet.x - 1] > 2|| represent.map[bullet.y][bullet.x] > 2) {
			bullet.x = (bullet.x - 2);//총알이 벽이 아닌 물체를 통과할경우 발생하는 오류해결
			index_pass = true;
			break;//좌우 이동시 총알을 지우는 과정즉 printf("  ")를 삽입하는 과정에서 삽입 뒤부터 밀려나는 현상을 막아줌
		}
	     printf("◎");
		Sleep(A - 35);
		break;

	case 4:
		erasebullet();
		bullet.y--;//위쪽
		gotoxy(bullet.x, bullet.y);
		if ((bullet.y == 0 || represent.map[bullet.y][bullet.x] == 2|| represent.map[bullet.y+1][bullet.x] == 2)&& represent.map[bullet.y+1][bullet.x] != 1) {
			bullet.Active = false;
			index_portalcount = index_portalcount - 1;//벽에 부딪히는 걸로 포탈 카운트를 하지 않도록
			break;
		};
		if (represent.map[bullet.y][bullet.x] == 1|| represent.map[bullet.y+1][bullet.x] == 1) {
			bullet.Active = false;
			portalprocess(bullet.x, bullet.y);
			break;
		}
		printf("◎");
		Sleep(A - 10);
		break;
		
	}

}

void vectorfield(void)
{
	eraseplayer();
	if (stPlayer.fdir == 1) stPlayer.x -= 2;
	else if (stPlayer.fdir == 2) stPlayer.x += 2;
	playersupply();
	Sleep(A);
}

void inputfunction(void)//방향키에 플레이어가 반응하도록 함
{	
	//플레이어 이동
	if (stPlayer.fActive == true) {
		if (GetAsyncKeyState(VK_LEFT) & 0X8000)
		{
			eraseplayer();//잔상제거
			stPlayer.x -= 2;//이동
			if (stPlayer.x < 0)stPlayer.x = 0;//최외벽을 넘어가지 못함
			if (represent.map[stPlayer.y][stPlayer.x] == 1 || represent.map[stPlayer.y][stPlayer.x] == 2
				|| represent.map[stPlayer.y][stPlayer.x] == 5|| represent.map[stPlayer.y][stPlayer.x] == 9
				|| represent.map[stPlayer.y][stPlayer.x] == 10)stPlayer.x += 2;//1,2는 벽 5는 유리
			if ((represent.map[stPlayer.y][stPlayer.x] == 3 || represent.map[stPlayer.y][stPlayer.x] == 4) && bullet.portala == false) {//포탈
				int color;

				if (represent.map[stPlayer.y][stPlayer.x] == 3) color = 2;//테스팅
				else color = 1;

				if (represent.map[portalinformation[color].y][portalinformation[color].x - 2] == 0) {
					stPlayer.x = portalinformation[color].x - 2;//포탈연결
					stPlayer.y = portalinformation[color].y;
				}
				else if (represent.map[portalinformation[color].y + 1][portalinformation[color].x] == 0) {
					stPlayer.x = portalinformation[color].x;//포탈연결
					stPlayer.y = portalinformation[color].y + 1;
				}
				else if (represent.map[portalinformation[color].y - 1][portalinformation[color].x] == 0) {
					stPlayer.x = portalinformation[color].x;//포탈연결
					stPlayer.y = portalinformation[color].y - 1;
				}
				else if (represent.map[portalinformation[color].y][portalinformation[color].x + 4] == 0) {
					stPlayer.x = portalinformation[color].x + 4;//포탈연결
					stPlayer.y = portalinformation[color].y;
				}
			}
			playersupply();
			Sleep(A);
		}
		if (GetAsyncKeyState(VK_RIGHT) & 0X8000)
		{
			eraseplayer();
			stPlayer.x += 2;
			if (stPlayer.x > (WIDTH - 2))stPlayer.x = (WIDTH - 2);
			if (represent.map[stPlayer.y][stPlayer.x] == 1 || represent.map[stPlayer.y][stPlayer.x] == 2
				|| represent.map[stPlayer.y][stPlayer.x] == 5||represent.map[stPlayer.y][stPlayer.x] == 9
				|| represent.map[stPlayer.y][stPlayer.x] == 10)stPlayer.x -= 2;

			if ((represent.map[stPlayer.y][stPlayer.x] == 3 || represent.map[stPlayer.y][stPlayer.x] == 4) && bullet.portala == false) {
				int color;

				if (represent.map[stPlayer.y][stPlayer.x] == 3) color = 2;//테스팅
				else color = 1;

				if (represent.map[portalinformation[color].y][portalinformation[color].x + 2] == 0 ) {
					stPlayer.x = portalinformation[color].x + 2;//포탈연결
					stPlayer.y = portalinformation[color].y;
				}
				else if (represent.map[portalinformation[color].y + 1][portalinformation[color].x] == 0) {
					stPlayer.x = portalinformation[color].x;//포탈연결
					stPlayer.y = portalinformation[color].y + 1;
				}
				else if (represent.map[portalinformation[color].y - 1][portalinformation[color].x] == 0) {
					stPlayer.x = portalinformation[color].x;//포탈연결
					stPlayer.y = portalinformation[color].y - 1;
				}
				else if (represent.map[portalinformation[color].y][portalinformation[color].x - 4] == 0) {
					stPlayer.x = portalinformation[color].x - 4;//포탈연결
					stPlayer.y = portalinformation[color].y;
				}
			}
			playersupply();
			Sleep(A);
		}
	}
	if (GetAsyncKeyState(VK_UP) & 0X8000)
	{
		eraseplayer();
		stPlayer.y--;
		if (stPlayer.y < 0)stPlayer.y = 0;
		if (represent.map[stPlayer.y][stPlayer.x] == 1 || represent.map[stPlayer.y][stPlayer.x] == 2 
			|| represent.map[stPlayer.y][stPlayer.x] == 5)stPlayer.y++;
		if ((represent.map[stPlayer.y][stPlayer.x] == 3|| represent.map[stPlayer.y][stPlayer.x] == 4) && bullet.portala == false) {
			int color;

			if (represent.map[stPlayer.y][stPlayer.x] == 3) color = 2;//테스팅
			else color = 1;

			if (represent.map[portalinformation[color].y - 1][portalinformation[color].x] == 0) {
				stPlayer.x = portalinformation[color].x;//포탈연결
				stPlayer.y = portalinformation[color].y - 1;
			}
			else if (represent.map[portalinformation[color].y + 1][portalinformation[color].x] == 0) {
				stPlayer.x = portalinformation[color].x;//포탈연결
				stPlayer.y = portalinformation[color].y + 1;
			}
			else if (represent.map[portalinformation[color].y][portalinformation[color].x - 2] == 0) {
				stPlayer.x = portalinformation[color].x - 2;//포탈연결
				stPlayer.y = portalinformation[color].y;
			}
			else if (represent.map[portalinformation[color].y][portalinformation[color].x + 2] == 0) {
				stPlayer.x = portalinformation[color].x + 2;//포탈연결
				stPlayer.y = portalinformation[color].y;
			}
		}
		if (represent.map[stPlayer.y][stPlayer.x] == 9) {//중력장입장
			stPlayer.fActive = false;
			stPlayer.fdir = 1;
		}
		else if (represent.map[stPlayer.y][stPlayer.x] == 10) {//중력장입장
			stPlayer.fActive = false;
			stPlayer.fdir = 2;
		}
		playersupply();
		Sleep(A);//심한 잔상
	}
	if (GetAsyncKeyState(VK_DOWN) & 0X8000)
	{
		eraseplayer();
		stPlayer.y ++;
		if (stPlayer.y > (HEIGHT-1))stPlayer.y = (HEIGHT-1);
		if (represent.map[stPlayer.y][stPlayer.x] == 1 || represent.map[stPlayer.y][stPlayer.x] == 2 
			|| represent.map[stPlayer.y][stPlayer.x] == 5)stPlayer.y--;
		if ((represent.map[stPlayer.y][stPlayer.x] == 3|| represent.map[stPlayer.y][stPlayer.x] == 4) && bullet.portala == false) {//플레이어가 하얀 포탈에 있고, 포탈이 한쌍이 모두 존재
			int color;
			
			if (represent.map[stPlayer.y][stPlayer.x] == 3) color = 2;//테스팅
			else color = 1;
			
			if (represent.map[portalinformation[color].y+1][portalinformation[color].x]==0) {
				stPlayer.x = portalinformation[color].x;//포탈연결
				stPlayer.y = portalinformation[color].y+1;
			}
			else if (represent.map[portalinformation[color].y - 1][portalinformation[color].x] == 0) {
				stPlayer.x = portalinformation[color].x;//포탈연결
				stPlayer.y = portalinformation[color].y - 1;
			}
			else if (represent.map[portalinformation[color].y][portalinformation[color].x - 2] == 0) {
				stPlayer.x = portalinformation[color].x - 2;//포탈연결
				stPlayer.y = portalinformation[color].y;
			}
			else if (represent.map[portalinformation[color].y][portalinformation[color].x + 2] == 0) {
				stPlayer.x = portalinformation[color].x + 2;//포탈연결
				stPlayer.y = portalinformation[color].y;
			}
		}
		if (represent.map[stPlayer.y][stPlayer.x] == 9) {
			stPlayer.fActive = false;
			stPlayer.fdir = 1;
		}
		else if (represent.map[stPlayer.y][stPlayer.x] == 10) {
			stPlayer.fActive = false;
			stPlayer.fdir = 2;
		}
		playersupply();
		Sleep(A);
	}

	if (GetAsyncKeyState(0x52) & 0X8000) {//R 포탈리셋
		portalreset();
	}

	if (index_stage == 7) {//게임 마무리
		if (GetAsyncKeyState(VK_SPACE) & 0X8000) {
			stPlayer.Active = false;
		}
	}

	//총알 발생
	if (index_portalcount < 2) {//포탈 갯수제한 한쌍이상 생성 불가
		long time_length= 0;
		
		if (index_portaltime == true) {//한번 발사하면 시간이 지나야 재발사 가능
			end_portal = clock();
			time_length = end_portal - start_portal;
		}
		if (time_length > 500) {//위와 동일 기능
			index_portaltime = false;
		}

		if (index_portaltime == false) {
			if (GetAsyncKeyState(0x44) & 0X8000)//D 오른쪽
			{
				if (bullet.Active == false) {//이미 다른 총알이 발사된 상태이면 이 총알은 발사 되지 않게하는 조건문
					bullet.Active = true;
					index_portaltime = true;//총알이 발사되면 시간이 지연된후 발사되기 위함이다.
					bulletsupply(1);
					index_portalcount++;
					start_portal = clock();
				}
			}

			if (GetAsyncKeyState(0x53) & 0X8000)//S 아래쪽
			{
    			if (bullet.Active == false) {//이미 다른 총알이 발사된 상태이면 이 총알은 발사 되지 않게하는 조건문
					bullet.Active = true;
					index_portaltime = true;
					bulletsupply(2);
					index_portalcount++;
					start_portal = clock();
				}
			}

			if (GetAsyncKeyState(0x41) & 0X8000)//A 왼쪽
			{
				if (bullet.Active == false) {//이미 다른 총알이 발사된 상태이면 이 총알은 발사 되지 않게하는 조건문
					bullet.Active = true;
					index_portaltime = true;
					bulletsupply(3);
					index_portalcount++;
					start_portal = clock();
				}
			}

			if (GetAsyncKeyState(0x57) & 0X8000)//W 위
			{
				if (bullet.Active == false) {//이미 다른 총알이 발사된 상태이면 이 총알은 발사 되지 않게하는 조건문
					bullet.Active = true;
					index_portaltime = true;
					bulletsupply(4);
					index_portalcount++;
					start_portal = clock();
				}
			}
		}
	}
}


void deadmenu(void)
{
	clear();
	Sleep(500);
	while (1)
	{
		gotoxy(1, 5);
		printf("○ 당신은 죽었습니다... ●");
		gotoxy(1, 11);
		printf("다시 시작하기 위해서는 y를 누르세요");
		gotoxy(1, 13);
		printf("게임을 종료하기 위해서는 n을 누르세요");
		if (GetAsyncKeyState(0x59) & 0X8000) {
			portalreset();
			index_stage = 0;
			index_key = 4;
			index_life = 3;
			index_swapstage = false;
			return;
		}
		if (GetAsyncKeyState(0x4E) & 0X8000) {
			exit(1);
		}
	}

}

void sortscore(void)
{
	int i, j, index;
	result tmp;

	for (j = 0; j < 11 - 1; j++) {
		index = j;
		for (i = j + 1; i < 11; i++) {

			if (player[i].score < player[index].score) {
				index = i;
			}
		}
		tmp = player[j];
		player[j] = player[index];
		player[index] = tmp;
	}
}


void resultmenu(int index)//스코어 계산 랭킹등록, index==1인경우 게임을 마치고 스코어가 저장 되는 과정이 포함됨
{	
		clear();
		char name[10];
		FILE *fp;

		if (index == 1) {
			CONSOLE_CURSOR_INFO curinfor;
			GetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &curinfor);
			curinfor.bVisible = TRUE;//커서를 보이게 함
			SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &curinfor);

			gotoxy(8, 7);
			printf("이름을 입력해 주세요! :");
			
			scanf("%s", name);

			curinfor.bVisible = FALSE;//커서를 안 보이게 함
			SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &curinfor);

			clear();
		}

		fp = fopen("scorec.txt", "a");//없으면 생성 있으면 덧붙여쓰기

		if (index == 1) {//index가 1이면 결과값을 저장함 아니면 txt파일을 생성하기만 함	
			fprintf(fp, "%d %s\n", result_time, name);	
		}

		fclose(fp);

		fopen("scorec.txt", "r");//읽기
		for (int i = 0; i < 11; i++) {//새로 추가를 염두한 11개 index가 0인경우는 별의미 없음
			fscanf(fp, "%d %s", &player[i].score, &player[i].name);
		}
		fclose(fp);
		
		if (index == 1) {//index가 1이면 선택정렬 후 가장 안 좋게 나온 점수를 떨구고 랭크를 새로 작성함
			sortscore();
			fopen("scorec.txt", "w");//기존파일 내용 삭제후 새로 작성 
			for (int i = 0; i < 10; i++) {
				fprintf(fp, "%d %s\n", player[i].score, player[i].name);
			}
			fclose(fp);
		}

		while (1) {
			if (index == 1) {
				gotoxy(0, 0);
				printf("--------------------------------------------------");
				gotoxy(4, 1);
				printf("◇ %s ◆ 님의 점수는? ○ %d ●", name, result_time);
			}
			gotoxy(0, 2);
			printf("--------------------------------------------------");
			gotoxy(4, 3);
			printf("랭킹");
			gotoxy(15, 3);
			printf("플레이어");
			gotoxy(35, 3);
			printf("점수");
			gotoxy(0, 4);
			printf("--------------------------------------------------");
			for (int i = 0; i < 10; i++) {
				if (player[i].score != 2147483647) {
					gotoxy(4, 3 + (2 * (i + 1)));
					printf("%d등", i + 1);
					gotoxy(15, 3 + (2 * (i + 1)));
					printf("%s", player[i].name);
					gotoxy(35, 3 + (2 * (i + 1)));
					printf("%d", player[i].score);
				}
				else {
					gotoxy(4, 3 + (2 * (i + 1)));
					printf("%d등", i + 1);
					gotoxy(15, 3 + (2 * (i + 1)));
					printf("%s", player[i].name);
					gotoxy(35, 3 + (2 * (i + 1)));
					printf("NO DATA");
				}
			}
			if (index == 1) {
				gotoxy(3, 25);
				printf("다시 시작하기 위해서는 y를 누르세요");
			}
			else {
				gotoxy(3, 25);
				printf("다시 돌아가기 위해서는 y를 누르세요");
			}
			gotoxy(3, 27);
			printf("게임을 종료하기 위해서는 n을 누르세요");
			if (GetAsyncKeyState(0x59) & 0X8000) {//y
				if (index == 1) {
					portalreset();
					index_stage = 0;
					index_key = 4;
					index_life = 3;
					index_swapstage = false;
					return;
				}
				else {
					clear();
					return;
				}
			}
			if (GetAsyncKeyState(0x4E) & 0X8000) {//n
				exit(1);
			}
		}
	
}


void gamemain(void)
{
	
	stPlayer.x = 30; //플레이어 구조체가 처음 등장하는 좌표
	stPlayer.y = 15;//==
	stPlayer.Active = true;//플레이어를 활성화함

	clear();
	playersupply();
	start_timecheck = clock();

	while (1)
	{
		//whererureal();
		updatestage();
		draw_map(&represent);
		if (stPlayer.Active == true)
		{
			inputfunction();//사용자의 입력 받음,플레이어가 false면 조종 불가
			if (stPlayer.fActive == false) {
				vectorfield();
			}
			if(bullet.Active==true)bulletprocess(dir_bullet);//false면 총알 움직임 중지,dir은 총알 진행방향 전역변수
			constant_manage();//열쇠 관리

		}
		else break;
	}
	
}


int main()
{	
	init();//초기화
	
	while (1)
	{
		PlaySound(TEXT("songa.wav"), NULL, SND_ASYNC | SND_LOOP);
		start();
		howto_a();
		howto_b();
		howto_c();
		howto_d();
		skip = 0;
		PlaySound(NULL, 0, 0);
		PlaySound(TEXT("songb.wav"), NULL, SND_ASYNC | SND_LOOP);
		gamemain();
		if (stPlayer.Active == false) {
			if (index_stage == 7) {
				resultmenu(1);
			}
			else deadmenu();
		}
		PlaySound(NULL, 0, 0);
	}
	return 0;
	
}